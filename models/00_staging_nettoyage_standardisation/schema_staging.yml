version: 2

models:
  # =========================================================
  # 1. DATA SET : INDIVIDUS 
  # =========================================================

  - name: 00_transfo_donnees_rh 
    description: '{{doc("doc_00_transfo_donnees_rh") }}'
    columns:
      - name: employee_id
        description: '{{doc("cle_00_transfo_donnees_rh") }}'
        tests:
          - unique
          - not_null

  - name: 01_transfo_historique_carriere 
    description: '{{doc("doc_01_transfo_historique_carriere") }}'
    columns:
      - name: employee_id
        description: '{{doc("cle_01_transfo_historique_carriere") }}'
        tests:
          - unique
          - not_null

  - name: 02_transfo_absenteisme 
    description: '{{doc("doc_02_transfo_absenteisme") }}'
    columns:
      - name: employee_id
        description: '{{doc("cle_02_transfo_absenteisme") }}'
        tests:
          - unique
          - not_null

  - name: 03_transfo_enquete_satisfaction # (clé composée pour 1 employé pour 1 date)
    description: '{{doc("doc_03_transfo_enquete_satisfaction") }}'
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - employee_id
            - date_enquete # 1 employé ne peut avoir qu'1 réponse par date

  - name: 04_transfo_feedback360 # (clé composée pour 1 employé pour 1 date)
    description: '{{doc("doc_04_transfo_feedback360") }}'
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - employee_id
            - date_evaluation # 1 employé ne peut avoir qu'1 seule évaluation par date
    
  # =========================================================
  # 2. DATA SET : ENTREPRISE (Granularité par Période)
  # =========================================================
  
  - name: 05_transfo_histo_mensuel_20_24 
    description: '{{doc("doc_05_transfo_histo_mensuel_20_24") }}'
    columns:
      - name: mois_histo 
        description: '{{doc("cle_05_transfo_histo_mensuel_20_24") }}'
        tests:
          - unique
          - not_null

  - name: 06_transfo_cohorte
    description: '{{doc("doc_06_transfo_cohorte") }}'
    columns:
      - name: mois_embauche 
        description: '{{doc("cle_06_transfo_cohorte") }}'
        tests:
          - unique
          - not_null
  
  - name: 07_transfo_donnees_contextuelles
    description: '{{doc("doc_07_transfo_donnees_contextuelles") }}'
    columns:
      - name: mois_contexte 
        description: '{{doc("cle_07_transfo_donnees_contextuelles") }}'
        tests:
          - unique
          - not_null

  - name: 08_transfo_evenements_entreprise 
    description: '{{doc("doc_08_transfo_evenements_entreprise") }}'
    columns:
      - name: date_evenement 
        description: '{{doc("cle_08_transfo_evenements_entreprise") }}'
        tests:
          - unique
          - not_null

  - name: 09_transfo_evenements_historiques 
    description: '{{doc("doc_09_transfo_evenements_historiques") }}'
    columns:
      - name: date_evenement_historique
        description: '{{doc("cle_09_transfo_evenements_historiques") }}'
        tests:
          - unique
          - not_null